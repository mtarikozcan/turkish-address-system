# TEKNOFEST 2025 Turkish Address Resolution System
# PostgreSQL Configuration for Testing Environment
#
# This configuration is optimized for integration testing with PostGIS
# and Turkish address data processing.

# Memory Settings (for 1GB container limit)
shared_buffers = 256MB              # 25% of available memory
effective_cache_size = 768MB        # 75% of available memory
work_mem = 16MB                     # Per operation memory
maintenance_work_mem = 64MB         # For VACUUM, CREATE INDEX

# Connection Settings
max_connections = 100               # Suitable for testing
superuser_reserved_connections = 3

# Write Performance (optimized for testing)
checkpoint_timeout = 30min          # Less frequent checkpoints
checkpoint_completion_target = 0.9  # Spread checkpoint I/O
max_wal_size = 1GB
min_wal_size = 80MB

# Query Planner
random_page_cost = 1.1              # SSD optimized
effective_io_concurrency = 200      # For parallel I/O
default_statistics_target = 100     # Better query plans

# PostGIS Specific
max_locks_per_transaction = 128     # For spatial operations

# Logging (for debugging)
log_statement = 'mod'               # Log DML statements
log_duration = off                  # Don't log all durations
log_min_duration_statement = 100    # Log queries > 100ms
log_line_prefix = '%t [%p]: [%l-1] user=%u,db=%d,app=%a,client=%h '
log_checkpoints = on
log_connections = on
log_disconnections = on
log_lock_waits = on

# Turkish Locale Settings
lc_messages = 'en_US.UTF-8'
lc_monetary = 'tr_TR.UTF-8'
lc_numeric = 'tr_TR.UTF-8'
lc_time = 'tr_TR.UTF-8'

# Performance Monitoring
shared_preload_libraries = 'pg_stat_statements'
pg_stat_statements.max = 10000
pg_stat_statements.track = all

# Autovacuum (aggressive for testing)
autovacuum = on
autovacuum_max_workers = 2
autovacuum_naptime = 30s
autovacuum_vacuum_threshold = 50
autovacuum_analyze_threshold = 50

# Resource Limits
temp_file_limit = 1GB
statement_timeout = 60000           # 60 seconds max query time

# Turkish Text Search
default_text_search_config = 'pg_catalog.turkish'